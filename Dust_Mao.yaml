# è¿œç¨‹è®¢é˜…

proxy-providers:
  # å®šä¹‰é”šç‚¹
  provider-base: &provider-base { type: http, interval: 42300, health-check: { enable: true, url: http://www.gstatic.com/generate_204, interval: 300 } }

  # æä¾›è€…é…ç½®ï¼ˆå•è¡Œæ ¼å¼ï¼Œç¡®ä¿åˆ—è¡¨é¡¹ï¼‰
  - { name: Red-Airport, <<: *provider-base, path: ./proxy_providers/subscribe_Red_Only.yaml, url: "http://nas.classchen.fun:3001/jesusya/download/Red?target=ClashMeta" }
  - { name: Self-Build, <<: *provider-base, path: ./proxy_providers/subscribe_CF.yaml, url: "http://nas.classchen.fun:3001/jesusya/download/subcheck?target=ClashMeta" }

proxy-groups:
  # å®šä¹‰é”šç‚¹
  url-test-base: &url-test-base { type: url-test, interval: 180, tolerance: 50, lazy: false, url: 'http://www.gstatic.com/generate_204', disable-udp: false, timeout: 2000, max-failed-times: 3, hidden: false, include-all-providers: true }
  select-common-proxies: &select-common-proxies [HongKong, TaiWan, Japan, Korea, Singapore, America, MyNodes, AllServer]
  select-streaming-proxies: &select-streaming-proxies [Proxy, HongKong, Singapore, TaiWan, Japan, Korea, America]
  direct-proxy: &direct-proxy [DIRECT, Proxy]
  icon-prefix: &icon-prefix "https://gh-proxy.com/"

  # ä»£ç†ç»„é…ç½®ï¼ˆå•è¡Œæ ¼å¼ï¼‰
  - { name: Proxy, type: select, icon: "https://gh-proxy.com/https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Rocket.png", proxies: *select-common-proxies }
  - { name: Final, type: select, icon: "https://gh-proxy.com/https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Final.png", proxies: [Proxy, DIRECT] }
  - { name: AIGC, type: select, icon: "https://gh-proxy.com/https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/ChatGPT.png", proxies: [TaiWan, Singapore, America, Japan, Korea, MyNodes] }
  - { name: YouTube, type: select, icon: "https://gh-proxy.com/https://raw.githubusercontent.com/jesustoachild/clashicon/main/youtube-1.png", proxies: [Proxy, *select-common-proxies] }
  - { name: Spotify, type: select, icon: "https://gh-proxy.com/https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Spotify.png", proxies: [DIRECT, *select-common-proxies] }
  - { name: Adobe, type: select, icon: "https://gh-proxy.com/https://raw.githubusercontent.com/jesustoachild/clashicon/main/adobe-4.png", proxies: [Proxy, DIRECT, *select-common-proxies] }
  - { name: Zoom, type: select, icon: "https://gh-proxy.com/https://raw.githubusercontent.com/jesustoachild/clashicon/main/zoom.png", proxies: [DIRECT, Proxy, *select-common-proxies] }
  - { name: Games, type: select, icon: "https://gh-proxy.com/https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Game.png", proxies: *direct-proxy }
  - { name: Microsoft-CN, type: select, icon: "https://gh-proxy.com/https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Windows_11.png", proxies: *direct-proxy }
  - { name: Google-CN, type: select, icon: "https://gh-proxy.com/https://raw.githubusercontent.com/jesustoachild/clashicon/main/google-6.png", proxies: *direct-proxy }
  - { name: Apple-CN, type: select, icon: "https://gh-proxy.com/https://raw.githubusercontent.com/jesustoachild/clashicon/main/apple-4.png", proxies: *direct-proxy }
  - { name: Netflix, type: select, icon: "https://gh-proxy.com/https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Netflix.png", proxies: *select-streaming-proxies }
  - { name: AppleTV, type: select, icon: "https://gh-proxy.com/https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Infuse.png", proxies: *select-streaming-proxies }
  - { name: TikTok, type: select, icon: "https://gh-proxy.com/https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/TikTok.png", proxies: [DIRECT, *select-common-proxies] }
  - { name: Streaming, type: select, icon: "https://gh-proxy.com/https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Streaming.png", proxies: *select-streaming-proxies }
  - { name: NetworkTest, type: select, icon: "https://gh-proxy.com/https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Speedtest.png", proxies: [DIRECT, *select-common-proxies] }
  - { name: BiliBili, type: select, icon: "https://gh-proxy.com/https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/bilibili_3.png", proxies: [DIRECT, Proxy, *select-common-proxies] }
  - { name: Telegram, type: select, icon: "https://gh-proxy.com/https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Telegram_X.png", proxies: [Proxy, *select-common-proxies] }
  - { name: HongKong, <<: *url-test-base, icon: "https://gh-proxy.com/https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Hong_Kong.png", filter: '^(?=.*((?i)ğŸ‡­ğŸ‡°|é¦™æ¸¯))(?!(?=.*((?i)å›å›½|æ ¡å›­|æ¸¸æˆ|è‡ªå»º|CF))).*$' }
  - { name: TaiWan, <<: *url-test-base, icon: "https://gh-proxy.com/https://raw.githubusercontent.com/jesustoachild/clashicon/main/taiwan-1.png", filter: '^(?=.*((?i)ğŸ‡¹ğŸ‡¼|å°æ¹¾|(\b(TW|Tai|Taiwan)\b)))(?!.*((?i)å›å›½|æ ¡å›­|è‡ªå»º|CF|æ¸¸æˆ|ğŸ®|(\b(GAME)\b))).*$' }
  - { name: Japan, <<: *url-test-base, icon: "https://gh-proxy.com/https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Japan.png", filter: '^(?=.*((?i)ğŸ‡¯ğŸ‡µ|æ—¥æœ¬|å·æ—¥|ä¸œäº¬|å¤§é˜ª|æ³‰æ—¥|åŸ¼ç‰|(\b(JP|Japan)\b)))(?!.*((?i)å›å›½|æ ¡å›­|è‡ªå»º|CF|æ¸¸æˆ|ğŸ®|è‡ªå»º|(\b(GAME)\b))).*$' }
  - { name: Korea, <<: *url-test-base, icon: "https://gh-proxy.com/https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Korea.png", filter: '^(?=.*((?i)ğŸ‡°ğŸ‡·|éŸ©å›½|éŸ“|é¦–å°”|(\b(KR|Korea)\b)))(?!.*((?i)å›å›½|æ ¡å›­|è‡ªå»º|CF|æ¸¸æˆ|ğŸ®|(\b(GAME)\b))).*$' }
  - { name: Singapore, <<: *url-test-base, icon: "https://gh-proxy.com/https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Singapore.png", filter: '^(?=.*((?i)ğŸ‡¸ğŸ‡¬|æ–°åŠ å¡|ç‹®|(\b(SG|Singapore)\b)))(?!.*((?i)å›å›½|æ ¡å›­|è‡ªå»º|CF|æ¸¸æˆ|ğŸ®|(\b(GAME)\b))).*$' }
  - { name: America, <<: *url-test-base, icon: "https://gh-proxy.com/https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/United_States.png", filter: '^(?=.*((?i)ğŸ‡ºğŸ‡¸|ç¾å›½|æ³¢ç‰¹å…°|è¾¾æ‹‰æ–¯|ä¿„å‹’å†ˆ|å‡¤å‡°åŸ|è´¹åˆ©è’™|ç¡…è°·|æ‹‰æ–¯ç»´åŠ æ–¯|æ´›æ‰çŸ¶|åœ£ä½•å¡|åœ£å…‹æ‹‰æ‹‰|è¥¿é›…å›¾|èŠåŠ å“¥|(\b(US|United States)\b)))(?!.*((?i)è‡ªå»º|CF)).*$' }
  - { name: AllServer, type: select, icon: "https://gh-proxy.com/https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Airport.png", include-all-providers: true, filter: '^(?=.*(.))(?!.*((?i)ç¾¤|Game|åº”æ€¥|é‚€è¯·|è¿”åˆ©|å¾ªç¯|å®˜ç½‘|å®¢æœ|ç½‘ç«™|ç½‘å€|è·å–|è®¢é˜…|æµé‡|åˆ°æœŸ|æœºåœº|ä¸‹æ¬¡|ç‰ˆæœ¬|å®˜å€|å¤‡ç”¨|è¿‡æœŸ|å·²ç”¨|è”ç³»|é‚®ç®±|å·¥å•|è´©å–|é€šçŸ¥|å€’å–|é˜²æ­¢|å›½å†…|åœ°å€|é¢‘é“|æ— æ³•|è¯´æ˜|ä½¿ç”¨|æç¤º|ç‰¹åˆ«|è®¿é—®|æ”¯æŒ|æ•™ç¨‹|å…³æ³¨|æ›´æ–°|ä½œè€…|åº”æ€¥|æµé‡|ç´§æ€¥|å‰©ä½™|å®˜ç½‘|åˆ°æœŸ|Game|å¥—é¤|åŠ å…¥|(\b(USE|USED|TOTAL|Traffic|Expire|EMAIL|Panel|Channel|Author)\b|(\d{4}-\d{2}-\d{2}|\d+G)))).*$' }
  - { name: MyNodes, type: select, icon: "https://gh-proxy.com/https://raw.githubusercontent.com/jesustoachild/clashicon/main/building.png", include-all-providers: true, filter: 'è‡ªå»º' }
```
  
rule-providers:
  # å®šä¹‰é”šç‚¹
    domain-mrs: &domain-mrs { type: http, behavior: domain, format: mrs }
    domain-text: &domain-text { type: http, behavior: domain, format: text }
    classical-text: &classical-text { type: http, behavior: classical, format: text }
    ipcidr-mrs: &ipcidr-mrs { type: http, behavior: ipcidr, format: mrs }

    # ä½¿ç”¨é”šç‚¹åˆå¹¶
    fakeip-filter: { <<: *domain-mrs, path: ./rules/fakeip-filter.mrs, url: "https://gh-proxy.com/https://github.com/DustinWin/ruleset_geodata/releases/download/mihomo-ruleset/fakeip-filter.mrs", interval: 86400 }
    private: { <<: *domain-mrs, path: ./rules/private.mrs, url: "https://gh-proxy.com/https://github.com/DustinWin/ruleset_geodata/releases/download/mihomo-ruleset/private.mrs", interval: 86400 }
    microsoft-cn: { <<: *domain-mrs, path: ./rules/microsoft-cn.mrs, url: "https://gh-proxy.com/https://github.com/DustinWin/ruleset_geodata/releases/download/mihomo-ruleset/microsoft-cn.mrs", interval: 86400 }
    apple-cn: { <<: *domain-mrs, path: ./rules/apple-cn.mrs, url: "https://gh-proxy.com/https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/apple.mrs", interval: 86400 }
    google-cn: { <<: *domain-mrs, path: ./rules/google-cn.mrs, url: "https://gh-proxy.com/https://github.com/DustinWin/ruleset_geodata/releases/download/mihomo-ruleset/google-cn.mrs", interval: 86400 }
    games-cn: { <<: *domain-mrs, path: ./rules/games-cn.mrs, url: "https://gh-proxy.com/https://github.com/DustinWin/ruleset_geodata/releases/download/mihomo-ruleset/games-cn.mrs", interval: 86400 }
    netflix: { <<: *domain-mrs, path: ./rules/netflix.mrs, url: "https://gh-proxy.com/https://github.com/DustinWin/ruleset_geodata/releases/download/mihomo-ruleset/netflix.mrs", interval: 86400 }
    disney: { <<: *domain-mrs, path: ./rules/disney.mrs, url: "https://gh-proxy.com/https://github.com/DustinWin/ruleset_geodata/releases/download/mihomo-ruleset/disney.mrs", interval: 86400 }
    max: { <<: *domain-mrs, path: ./rules/max.mrs, url: "https://gh-proxy.com/https://github.com/DustinWin/ruleset_geodata/releases/download/mihomo-ruleset/max.mrs", interval: 86400 }
    primevideo: { <<: *domain-mrs, path: ./rules/primevideo.mrs, url: "https://gh-proxy.com/https://github.com/DustinWin/ruleset_geodata/releases/download/mihomo-ruleset/primevideo.mrs", interval: 86400 }
    appletv: { <<: *domain-mrs, path: ./rules/appletv.mrs, url: "https://gh-proxy.com/https://github.com/DustinWin/ruleset_geodata/releases/download/mihomo-ruleset/appletv.mrs", interval: 86400 }
    youtube: { <<: *domain-mrs, path: ./rules/youtube.mrs, url: "https://gh-proxy.com/https://github.com/DustinWin/ruleset_geodata/releases/download/mihomo-ruleset/youtube.mrs", interval: 86400 }
    tiktok: { <<: *domain-mrs, path: ./rules/tiktok.mrs, url: "https://gh-proxy.com/https://github.com/DustinWin/ruleset_geodata/releases/download/mihomo-ruleset/tiktok.mrs", interval: 86400 }
    bilibili: { <<: *domain-mrs, path: ./rules/bilibili.mrs, url: "https://gh-proxy.com/https://github.com/DustinWin/ruleset_geodata/releases/download/mihomo-ruleset/bilibili.mrs", interval: 86400 }
    ai: { <<: *domain-mrs, path: ./rules/ai.mrs, url: "https://gh-proxy.com/https://github.com/DustinWin/ruleset_geodata/releases/download/mihomo-ruleset/ai.mrs", interval: 86400 }
    networktest: { <<: *classical-text, path: ./rules/networktest.list, url: "https://gh-proxy.com/https://github.com/DustinWin/ruleset_geodata/releases/download/mihomo-ruleset/networktest.list", interval: 86400 }
    tld-proxy: { <<: *domain-mrs, path: ./rules/tld-proxy.mrs, url: "https://gh-proxy.com/https://github.com/DustinWin/ruleset_geodata/releases/download/mihomo-ruleset/tld-proxy.mrs", interval: 86400 }
    proxy: { <<: *domain-mrs, path: ./rules/proxy.mrs, url: "https://gh-proxy.com/https://github.com/DustinWin/ruleset_geodata/releases/download/mihomo-ruleset/proxy.mrs", interval: 86400 }
    cn: { <<: *domain-mrs, path: ./rules/cn.mrs, url: "https://gh-proxy.com/https://github.com/DustinWin/ruleset_geodata/releases/download/mihomo-ruleset/cn.mrs", interval: 86400 }
    netflixip: { <<: *ipcidr-mrs, path: ./rules/netflixip.mrs, url: "https://gh-proxy.com/https://github.com/DustinWin/ruleset_geodata/releases/download/mihomo-ruleset/netflixip.mrs", interval: 86400 }
    telegramip: { <<: *ipcidr-mrs, path: ./rules/telegramip.mrs, url: "https://gh-proxy.com/https://github.com/DustinWin/ruleset_geodata/releases/download/mihomo-ruleset/telegramip.mrs", interval: 86400 }
    privateip: { <<: *ipcidr-mrs, path: ./rules/privateip.mrs, url: "https://gh-proxy.com/https://github.com/DustinWin/ruleset_geodata/releases/download/mihomo-ruleset/privateip.mrs", interval: 86400 }
    cnip: { <<: *ipcidr-mrs, path: ./rules/cnip.mrs, url: "https://gh-proxy.com/https://github.com/DustinWin/ruleset_geodata/releases/download/mihomo-ruleset/cnip.mrs", interval: 86400 }
    Adobe-domain: { <<: *domain-mrs, path: ./rules/Adobe-domain.mrs, url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/adobe.mrs", interval: 86400 }
    Spotify-domain: { <<: *domain-mrs, path: ./rules/spotify.mrs, url: "https://gh-proxy.com/https://github.com/DustinWin/ruleset_geodata/releases/download/mihomo-ruleset/spotify.mrs", interval: 86400 }
    Zoom-domain: { <<: *domain-mrs, path: ./rules/zoom.mrs, url: "https://gh-proxy.com/https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/zoom.mrs", interval: 86400 }
    my_direct: { <<: *domain-text, path: ./rules/my_direct.list, url: "https://gh-proxy.com/https://raw.githubusercontent.com/jesustoachild/myclash/refs/heads/main/my_direct.list", interval: 86400 }
    my_proxy: { <<: *domain-text, path: ./rules/my_proxy.list, url: "https://gh-proxy.com/https://raw.githubusercontent.com/jesustoachild/myclash/refs/heads/main/my_proxy.list", interval: 86400 }


rules:

  # è‹¥éœ€ç¦ç”¨ QUIC è¯·å–æ¶ˆæ³¨é‡Š QUIC ä¸¤æ¡è§„åˆ™
  #- AND,(AND,(DST-PORT,443),(NETWORK,UDP)),(NOT,((RULE-SET,cn))),REJECT
  #- AND,(AND,(DST-PORT,443),(NETWORK,UDP)),(NOT,((RULE-SET,cnip))),REJECT


  - RULE-SET,my_direct,DIRECT
  - RULE-SET,my_proxy,Proxy
  
  - DOMAIN-SUFFIX,grok.com,AIGC

  #- RULE-SET,applications,DIRECT
  #- RULE-SET,ads,Ads
  - RULE-SET,microsoft-cn,Microsoft-CN
  - RULE-SET,apple-cn,Apple-CN
  - RULE-SET,google-cn,Google-CN
  - RULE-SET,games-cn,Games
  - RULE-SET,netflix,Netflix
  - RULE-SET,disney,Streaming
  - RULE-SET,max,Streaming
  - RULE-SET,primevideo,Streaming
  - RULE-SET,appletv,AppleTV
  - RULE-SET,youtube,YouTube
  - RULE-SET,tiktok,TikTok
  - RULE-SET,bilibili,BiliBili
  - RULE-SET,ai,AIGC
  - RULE-SET,Adobe-domain,Adobe
  - RULE-SET,Zoom-domain,Zoom
  - RULE-SET,Spotify-domain,Spotify
  - RULE-SET,networktest,NetworkTest
  - RULE-SET,private,DIRECT
  - RULE-SET,cn,DIRECT
  - RULE-SET,tld-proxy,Proxy
  - RULE-SET,proxy,Proxy
  - RULE-SET,netflixip,Netflix,no-resolve
  - RULE-SET,telegramip,Telegram,no-resolve
  - RULE-SET,privateip,DIRECT,no-resolve
  - RULE-SET,cnip,DIRECT

  - MATCH,Final

dns:
  fake-ip-filter:
    - +.lan
    - +.local
    - 'rule-set:fakeip-filter,cn,private,apple-cn,google-cn,games-cn,microsoft-cn,my_direct'
    #- geosite:category-games


hosts:
  mywebdav.class: 192.168.31.18
  mywebdav.cl: 192.168.31.18
  z4s.class: 192.168.31.18
  z4s.cl: 192.168.31.18
  isos.class: 192.168.31.41
  isos.cl: 192.168.31.41
  ub.class: 192.168.31.9
  ub.cl: 192.168.31.9
  ha.class: 192.168.31.208
  ha.cl: 192.168.31.208
  9000.cl: 192.168.31.1
  9000.class: 192.168.31.1
  6000.class: 192.168.31.6
  6000.cl: 192.168.31.6
  pang.cl: 192.168.31.7
  pang7.cl: 192.168.31.7
  pang7.class: 192.168.31.7
  n1.cl: 192.168.31.2
  n1.class: 192.168.31.2
  awm.airmx.cn: 192.168.31.16
  i.airmx.cn: 192.168.31.16
  homeassistant.local: 192.168.31.208

  doh.pub: [1.12.12.12, 120.53.53.53, 2402:4e00::]
  dns.alidns.com: [223.5.5.5, 223.6.6.6, 2400:3200::1, 2400:3200:baba::1]
  dns.google: [8.8.8.8, 8.8.4.4, 2001:4860:4860::8888, 2001:4860:4860::8844]
  cloudflare-dns.com: [1.1.1.1, 1.0.0.1, 2606:4700:4700::1111, 2606:4700:4700::1001]

geox-url:                                                                                                                                                                  
  geosite: https://gh-proxy.com/https://github.com/MetaCubeX/meta-rules-dat/releases/download/latest/geosite.dat                                                       
  mmdb: https://gh-proxy.com/https://github.com/MetaCubeX/meta-rules-dat/releases/download/latest/geoip-lite.metadb                                                    
  geoip: https://gh-proxy.com/https://github.com/MetaCubeX/meta-rules-dat/releases/download/latest/geoip-lite.dat                                                      
  asn: https://gh-proxy.com/https://github.com/MetaCubeX/meta-rules-dat/releases/download/latest/GeoLite2-ASN.mmdb                                                     
geo-auto-update: true                                                                                                                                                      
geo-update-interval: 24    

tls:
  certificate: /etc/sslkey/clash.classchen.fun.crt
  private-key: /etc/sslkey/clash.classchen.fun.key

external-controller-tls: 0.0.0.0:9467
